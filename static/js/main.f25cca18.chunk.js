(this.webpackJsonpgates=this.webpackJsonpgates||[]).push([[0],{23:function(t,e){},24:function(t,e){},32:function(t,e,i){},33:function(t,e,i){},34:function(t,e,i){},36:function(t,e,i){},38:function(t,e,i){},40:function(t,e,i){},46:function(t,e,i){"use strict";i.r(e);var n,s=i(3),o=i.n(s),a=i(25),r=i.n(a),c=(i(32),function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,48)).then((function(e){var i=e.getCLS,n=e.getFID,s=e.getFCP,o=e.getLCP,a=e.getTTFB;i(t),n(t),s(t),o(t),a(t)}))}),h=i(1),u=i(2),l=i(7),d=i(6),p=(i(33),i(34),i(0)),v=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(t){var n;return Object(h.a)(this,i),(n=e.call(this,t)).state={open:!1},n}return Object(u.a)(i,[{key:"render",value:function(){var t=this,e=["sidebar"];return this.state.open||e.push("collapsed"),Object(p.jsxs)("div",{className:e.join(" "),onMouseLeave:function(e){return t.handleMouseExit(e)},children:[Object(p.jsx)("div",{className:"floaty",onMouseEnter:function(e){return t.handleMouseEnter(e)}}),Object(p.jsx)("div",{className:"sidebar-content",children:this.props.content}),Object(p.jsx)("div",{className:"divider",children:Object(p.jsx)("button",{className:"handle",onClick:function(e){return t.handleMouseDown(e)},children:"*"})})]})}},{key:"handleMouseEnter",value:function(t){this.setState({open:!0})}},{key:"handleMouseExit",value:function(t){this.setState({open:!1})}},{key:"handleMouseDown",value:function(t){this.setState((function(t,e){return{open:!t.open}}))}}]),i}(o.a.Component),f=(i(36),i(10)),b=i(4),y=i(9),m=i(8),g=i(18),O=i(11),j=i.n(O),w=i(17),x=i(47),k=i(27),P=["onGateMouseDown","onGateMouseUp","onGateContextMenu"],M=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(t){var n;return Object(h.a)(this,i),(n=e.call(this,t)).state={},n}return Object(u.a)(i,[{key:"getTransforms",value:function(){var t=this.props.logicComponent.geometry.position,e=t.x,i=t.y;return["translate(".concat(e," ").concat(i,")"),"rotate(".concat(this.props.logicComponent.geometry.rotation,")")].join(" ")}},{key:"render",value:function(){var t=this.props.handlers,e=(t.onGateMouseDown,t.onGateMouseUp,t.onGateContextMenu,Object(k.a)(t,P)),i=this.props.logicComponent.pins().map((function(t){return t.render(e)})),n=this.props.logicComponent,s=["component"];return n.body.selected&&s.push("selected"),Object(p.jsxs)("g",{className:s.join(" "),"data-ctype":n.subtype,"data-uuid":n.uuid,transform:this.getTransforms(),children:[Object(p.jsx)("path",{d:n.d,onMouseDown:this.props.handlers.onGateMouseDown,onMouseUp:this.props.handlers.onGateMouseUp,onMouseMove:this.props.handlers.onGateMouseMove,onContextMenu:this.props.handlers.onGateContextMenu}),n.extraRender(),i]})}}]),i}(o.a.Component);!function(t){t[t.VariableShape=1]="VariableShape",t[t.IBussable=2]="IBussable",t[t.OBussable=4]="OBussable",t[t.SingleOutput=8]="SingleOutput",t[t.MergingPins=16]="MergingPins",t[t.Mux=32]="Mux",t[t.Bussed=64]="Bussed"}(n||(n={}));var N,T=function(){function t(e){var i,n,s;Object(h.a)(this,t),this.__fieldWidth=0,this.__width=void 0,this.__d="",this.flags=void 0,this.uuid=void 0,this.type=void 0,this.subtype=void 0,this.scope=void 0,this.board=void 0,this.delay=void 0,this.body=void 0,this.geometry=void 0,this.inputPins=[],this.outputPins=[],this.uuid=Object(x.a)(),this.scope=e.scope,this.flags=e.flags,this.type=e.type,this.subtype=e.subtype,this.delay=null!==(i=e.delay)&&void 0!==i?i:1,this.__width=null!==(n=e.width)&&void 0!==n?n:1,this.board=e.board,this.fieldWidth=null!==(s=e.fieldWidth)&&void 0!==s?s:0,this.reset()}return Object(u.a)(t,[{key:"updateGeometry",value:function(t){var e=this.scope,i=e.Group,n=e.Point;this.body&&this.body.remove(),this.body=this.setUpBody(t),this.geometry||(this.geometry=new i,this.geometry.pivot=new n(0,0),this.geometry.applyMatrix=!1),this.setUpPins(t),this.geometry.addChild(this.body),this.geometry.addChildren(this.pins().map((function(t){return t.geometry}))),this.__d=this.body.exportSVG().getAttribute("d"),this.body.data={type:"Component",logic:this,geometry:this.geometry}}},{key:"hasProperty",value:function(t){return 0!==(this.flags&t)}},{key:"setProperty",value:function(t){this.flags|=t}},{key:"clearProperty",value:function(t){this.flags&=this.bitMask(32)^t}},{key:"bitMask",value:function(t){var e;return(1<<(t=null!==(e=t)&&void 0!==e?e:this.width))-1}},{key:"pins",value:function(){return[].concat(Object(w.a)(this.inputPins),Object(w.a)(this.outputPins))}},{key:"clearPins",value:function(){var t,e=Object(y.a)(this.pins());try{for(e.s();!(t=e.n()).done;){t.value.remove()}}catch(i){e.e(i)}finally{e.f()}this.inputPins=[],this.outputPins=[]}},{key:"setUpPins",value:function(t){this.inputPins=[].concat(Object(w.a)(this.setUpInputPins(t)),Object(w.a)(this.setUpSelectorPins(t))),this.outputPins=this.setUpOutputPins(t)}},{key:"setUpInputPins",value:function(t){return[]}},{key:"setUpOutputPins",value:function(t){return[]}},{key:"setUpSelectorPins",value:function(t){return[]}},{key:"fieldWidth",get:function(){return this.__fieldWidth},set:function(t){this.updateGeometry(t),this.__fieldWidth=t}},{key:"width",get:function(){return this.__width},set:function(t){this.__width!==t&&(this.__width=t)}},{key:"d",get:function(){return this.__d}},{key:"postEvent",value:function(t,e){var i,n;e=null!==(i=e)&&void 0!==i?i:this.outputPins[0],null===(n=this.board)||void 0===n||n.postEvent(t,e,this.delay)}},{key:"remove",value:function(){var t;this.clearPins(),delete this.body.data.logic,this.body.remove(),this.geometry.remove(),null===(t=this.board)||void 0===t||t.removeComponent(this.uuid)}},{key:"extraRender",value:function(){return[]}},{key:"render",value:function(t){return Object(p.jsx)(M,Object(m.a)({},this.getRenderParams(t)),this.uuid)}},{key:"getRenderParams",value:function(t){var e,i,n,s;return{type:this.subtype,logicComponent:this,scope:this.scope,handlers:{onGateMouseDown:null===t||void 0===t||null===(e=t.onGateMouseDown)||void 0===e?void 0:e.bind(void 0,this),onGateMouseUp:null===t||void 0===t||null===(i=t.onGateMouseUp)||void 0===i?void 0:i.bind(void 0,this),onGateMouseMove:null===t||void 0===t||null===(n=t.onGateMouseMove)||void 0===n?void 0:n.bind(void 0,this),onGateContextMenu:null===t||void 0===t||null===(s=t.onGateContextMenu)||void 0===s?void 0:s.bind(void 0,this),onPinMouseDown:null===t||void 0===t?void 0:t.onPinMouseDown,onPinMouseUp:null===t||void 0===t?void 0:t.onPinMouseUp,onPinMouseMove:null===t||void 0===t?void 0:t.onPinMouseMove,onPinContextMenu:null===t||void 0===t?void 0:t.onPinContextMenu}}}}]),t}();!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.GATE=1]="GATE",t[t.INPUT=2]="INPUT",t[t.OUTPUT=3]="OUTPUT",t[t.COMPOSITE_BUILT_IN=4]="COMPOSITE_BUILT_IN",t[t.COMPOSITE_CUSTOM=5]="COMPOSITE_CUSTOM"}(N||(N={}));var U=N;function C(){var t=new j.a.PaperScope;return t.setup(),t.project.draw=function(){},t}var S,D,L=C(),R="M 0 0 L 8 0 Q 22.72 0 32 16 Q 22.72 32 8 32 L 0 32 Q 8 16 0 0 Z",I=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(t){var n;return Object(h.a)(this,i),(n=e.call(this,t)).state={},n}return Object(u.a)(i,[{key:"render",value:function(){var t,e,i,n=this.props.pin.geometry.data;this.props.pin.geometry.data={};var s=this.props.pin.geometry.exportSVG().getAttribute("d");this.props.pin.geometry.data=n;var o={d:s},a=["pin"];(null===(t=this.props.pin.geometry)||void 0===t?void 0:t.selected)&&a.push("selected");var r=Object(b.a)(this.props.pin.anchor,1)[0];return Object(p.jsxs)("g",{className:a.join(" "),onMouseDown:null===(e=this.props.handlers)||void 0===e?void 0:e.onPinMouseDown,onMouseUp:null===(i=this.props.handlers)||void 0===i?void 0:i.onPinMouseUp,onContextMenu:function(){return console.log("context p!")},children:[Object(p.jsx)("circle",{className:"anchor",cx:r.x,cy:r.y,r:5}),Object(p.jsx)("path",Object(m.a)({},o))]},this.props.pin.uuid)}}]),i}(o.a.Component),G=function(){function t(e){var i,n,s;Object(h.a)(this,t),this.v=void 0,this.x=void 0,this.z=void 0,this.v=null!==(i=e.v)&&void 0!==i?i:0,this.x=null!==(n=e.x)&&void 0!==n?n:0,this.z=null!==(s=e.z)&&void 0!==s?s:0}return Object(u.a)(t,[{key:"eq",value:function(t){return this.v===t.v&&this.x===t.x&&this.z===t.z}},{key:"ne",value:function(t){return this.v!==t.v||this.x!==t.x||this.z!==t.z}},{key:"negated",value:function(e){var i=(1<<e)-1;return new t({v:~this.v&~this.x&~this.z&i,x:this.x,z:this.z})}}]),t}(),E=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(){return Object(h.a)(this,i),e.apply(this,arguments)}return Object(u.a)(i,[{key:"render",value:function(){var t,e=this.props.i,i=e.x,n=e.y,s=this.props.o,o=s.x,a=s.y,r=this.props.ic,c=r.x,h=r.y,u=this.props.oc,l=u.x,d=u.y,v="M ".concat(i-1," ").concat(n," A ").concat(1," ").concat(1," 180 0 0 ").concat(i+1," ").concat(n," "),f="A ".concat(1," ").concat(1," 180 0 0 ").concat(i-1," ").concat(n," "),b="M ".concat(o-1," ").concat(a," A ").concat(1," ").concat(1," 180 0 0 ").concat(o+1," ").concat(a," "),y="A ".concat(1," ").concat(1," 180 0 0 ").concat(o-1," ").concat(a," "),m="".concat(v," ").concat(f," M ").concat(i," ").concat(n," C ").concat(c," ").concat(h," ").concat(l," ").concat(d," ").concat(o," ").concat(a," ").concat(b," ").concat(y),g=this.props.state;return t=g.x||g.z?"error":g.v?"on":"off",Object(p.jsxs)("g",{children:[Object(p.jsx)("path",{className:"connection-outer",d:m}),Object(p.jsx)("path",{fillRule:"nonzero",className:"connection-inner ".concat(t),d:m}),this.props.width>1&&Object(p.jsx)("path",{fillRule:"nonzero",className:"connection-inner bus",d:m})]})}}]),i}(o.a.Component),A=function(){function t(e){var i,n;Object(h.a)(this,t),this.uuid=void 0,this.source=void 0,this.sink=void 0,this.hidden=void 0,this.board=void 0,this.uuid=null!==(i=e.uuid)&&void 0!==i?i:Object(x.a)(),this.source=e.source,this.sink=e.sink,this.hidden=null!==(n=e.hidden)&&void 0!==n&&n,this.board=e.board}return Object(u.a)(t,[{key:"remove",value:function(){var t;this.source.connections.delete(this.uuid),this.sink.connections.delete(this.uuid),null===(t=this.board)||void 0===t||t.removeConnection(this.uuid)}},{key:"render",value:function(){var t=Object(b.a)(this.source.anchor,2),e=t[0],i=t[1],n=Object(b.a)(this.sink.anchor,2),s=n[0],o=n[1];e=this.source.transform(e),s=this.sink.transform(s);var a=Math.min(e.getDistance(s),30),r=e.add(i.multiply(a)),c=s.add(o.multiply(a));return Object(p.jsx)(E,{connection:this,state:this.source.state,width:this.source.width,i:e,o:s,ic:r,oc:c},this.uuid)}}]),t}();!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(S||(S={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.INPUT=1]="INPUT",t[t.OUTPUT=2]="OUTPUT"}(D||(D={}));var _,B=function(){function t(e){var i,n,s;Object(h.a)(this,t),this.parent=void 0,this.connectionAnchor=void 0,this.uuid=void 0,this.board=void 0,this.width=void 0,this.geometry=void 0,this.not=void 0,this.orientation=void 0,this.pinType=void 0,this.state=void 0,this.connections=new Map,this.uuid=Object(x.a)(),this.parent=e.parent,this.width=null!==(i=e.width)&&void 0!==i?i:1,this.orientation=null!==(n=e.orientation)&&void 0!==n?n:S.LEFT,this.pinType=e.pinType,this.not=null!==(s=e.not)&&void 0!==s&&s,this.state=new G({}),this.board=e.board}return Object(u.a)(t,[{key:"setLogicState",value:function(t){switch(this.state=t,this.pinType){case D.INPUT:this.parent.operate();break;case D.OUTPUT:this.updateNext();break;default:throw new Error}}},{key:"updateNext",value:function(){if(this.pinType!==D.OUTPUT)throw new Error;var t,e=Object(y.a)(this.connections.values());try{for(e.s();!(t=e.n()).done;){var i=t.value.sink;this.state.ne(i.state)&&i.setLogicState(this.state),i.parent.operate()}}catch(n){e.e(n)}finally{e.f()}}},{key:"disconnect",value:function(){this.connections.forEach((function(t){return t.remove()})),this.connections.clear()}},{key:"canConnect",value:function(t){if(this.width!==t.width)return!1;switch(this.pinType){case D.INPUT:return t.pinType===D.OUTPUT;case D.OUTPUT:return t.pinType===D.INPUT}return!1}},{key:"connectTo",value:function(t){if(!this.canConnect(t))return null;if(this.pinType===D.INPUT){if(this.isConnectedTo(t))return null;this.disconnect();var e=new A({source:t,sink:this,board:this.board});return this.connections.set(e.uuid,e),t.connections.set(e.uuid,e),this.setLogicState(t.state),e}return t.connectTo(this)}},{key:"isConnectedTo",value:function(t){return this.connections.has(t.uuid)}},{key:"remove",value:function(){var t,e;this.disconnect(),null===(t=this.geometry)||void 0===t||t.remove(),null===(e=this.geometry)||void 0===e||delete e.data.logic}},{key:"render",value:function(t){return Object(p.jsx)(I,Object(m.a)({},this.getRenderParams(t)),this.uuid)}},{key:"getRenderParams",value:function(t){var e,i,n,s;return{pin:this,type:this.pinType,handlers:{onPinMouseUp:null===t||void 0===t||null===(e=t.onPinMouseUp)||void 0===e?void 0:e.bind(void 0,this),onPinMouseDown:null===t||void 0===t||null===(i=t.onPinMouseDown)||void 0===i?void 0:i.bind(void 0,this),onPinMouseMove:null===t||void 0===t||null===(n=t.onPinMouseMove)||void 0===n?void 0:n.bind(void 0,this),onPinContextMenu:null===t||void 0===t||null===(s=t.onPinContextMenu)||void 0===s?void 0:s.bind(void 0,this)}}}},{key:"updateGeometry",value:function(t){this.geometry&&this.geometry.remove();var e,i=this.parent.scope,n=i.CompoundPath,s=i.Path,o=i.Point;switch((e=this.not?new n("M -4 0 A 4 4 180 0 1 4 0 A 4 4 180 0 1 -4 0 Z M 3.47 -2 L 18.5 -2 L 20 0 L 18.5 2 L 3.467 2 A 4 4 -20 0 0 3.467 -2 Z"):new s("M -4 -2 L 18.5 -2 L 20 0 L 18.5 2 L -4 2 Z")).pivot=new o(0,0),this.orientation){case S.UP:e.rotate(-90),this.connectionAnchor=new o(0,-18);break;case S.DOWN:e.rotate(90),this.connectionAnchor=new o(0,18);break;case S.LEFT:e.rotate(180),this.connectionAnchor=new o(-18,0);break;case S.RIGHT:this.connectionAnchor=new o(18,0);break;default:throw new Error("Unknown pin orientation")}e.translate(t),this.geometry=e.subtract(this.parent.body),e.remove(),this.geometry.data.type="Pin",this.geometry.data.logical=this}},{key:"transform",value:function(t){return this.parent.geometry.matrix.transform(t)}},{key:"rotation",get:function(){return this.parent.geometry.rotation}},{key:"pos",get:function(){return this.geometry.position}},{key:"anchor",get:function(){return[this.pos.add(this.connectionAnchor),this.connectionAnchor.rotate(this.rotation,new this.parent.scope.Point(0,0)).divide(18)]}}]),t}();!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.AND=1]="AND",t[t.NAND=2]="NAND",t[t.OR=3]="OR",t[t.NOR=4]="NOR",t[t.XOR=5]="XOR",t[t.XNOR=6]="XNOR",t[t.BUF=7]="BUF",t[t.NOT=8]="NOT"}(_||(_={}));var W,z=_;function F(t){switch(t){case z.NAND:case z.NOR:case z.XNOR:case z.NOT:return!0;case z.AND:case z.OR:case z.XOR:case z.BUF:return!1;default:throw new Error("Unsupported Gate Type(".concat(t,")"))}}function X(t){switch(t){case z.AND:case z.NAND:case z.OR:case z.NOR:case z.XOR:case z.XNOR:return 4;case z.BUF:case z.NOT:return 1;default:throw new Error("Unsupported Gate Type(".concat(t,")"))}}var Q=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(t){var n;return Object(h.a)(this,i),(n=e.call(this,Object(m.a)({flags:0,type:U.GATE,fieldWidth:Math.min(2,X(t.subtype))},t))).opFunc=void 0,n.opFunc=i.opFuncs[n.subtype].bind(Object(g.a)(n)),n}return Object(u.a)(i,[{key:"opAnd",value:function(){var t,e=this.bitMask(),i=0,n=0,s=Object(y.a)(this.inputPins);try{for(s.s();!(t=s.n()).done;){var o=t.value;n|=~(o.state.v|o.state.x|o.state.z),e&=o.state.v,i|=o.state.x,i|=o.state.z}}catch(a){s.e(a)}finally{s.f()}return new G({v:e,x:i&=~n,z:0})}},{key:"opNand",value:function(){return this.opAnd().negated(this.width)}},{key:"opOr",value:function(){var t,e=0,i=0,n=Object(y.a)(this.inputPins);try{for(n.s();!(t=n.n()).done;){var s=t.value;e|=s.state.v,i|=s.state.x,i|=s.state.z}}catch(o){n.e(o)}finally{n.f()}return new G({v:e,x:i&=~e,z:0})}},{key:"opNor",value:function(){return this.opOr().negated(this.width)}},{key:"opXor",value:function(){var t,e=0,i=0,n=Object(y.a)(this.inputPins);try{for(n.s();!(t=n.n()).done;){var s=t.value;e^=s.state.v,i|=s.state.x,i|=s.state.z}}catch(o){n.e(o)}finally{n.f()}return new G({v:e&~i,x:i,z:0})}},{key:"opXnor",value:function(){return this.opXor().negated(this.width)}},{key:"opBuf",value:function(){var t=Object(b.a)(this.inputPins,1)[0],e=t.state.v,i=t.state.x|t.state.z;return new G({v:e,x:i,z:0})}},{key:"opNot",value:function(){var t=Object(b.a)(this.inputPins,1)[0],e=t.state.x|t.state.z,i=~t.state.v&this.bitMask()&~e;return new G({v:i,x:e,z:0})}},{key:"operate",value:function(){var t=this.opFunc();this.postEvent(t,this.outputPins[0])}},{key:"setUpBody",value:function(){return new(0,this.scope.CompoundPath)(function(t){switch(t){case z.AND:case z.NAND:return"M 0 0 L 16 0 A 16 16 -180 0 1 16 32 L 0 32 L 0 0 Z";case z.OR:case z.NOR:return R;case z.XOR:case z.XNOR:return"M 0 0 L 8 0 Q 22.72 0 32 16 Q 22.72 32 8 32 L 0 32 Q 8 16 0 0 Z M -4 0 Q 4 16 -4 32 Q 4 16 -4 0 Z";case z.BUF:case z.NOT:return"M 0 0 L 32 16 L 0 32 L 0 0 Z";default:throw new Error("Unsupported Gate Type")}}(this.subtype))}},{key:"setUpInputPins",value:function(t){var e=this.inputPins.slice(0,t);this.inputPins.slice(t).forEach((function(t){return t.remove()}));for(var i=this.fieldWidth;i<t;++i)e.push(new B({parent:this,pinType:D.INPUT,orientation:S.LEFT,board:this.board}));for(var n=1===t?16:2===t?32/3:3===t?6:2,s=2===t?32/3:3===t?10:28/3,o=0;o<t;++o)e[o].updateGeometry(new j.a.Point(0,n+o*s));return e}},{key:"setUpOutputPins",value:function(){if(this.outputPins.length>0)return this.outputPins;var t=new B({parent:this,pinType:D.OUTPUT,orientation:S.RIGHT,not:F(this.subtype),board:this.board});return t.updateGeometry(new j.a.Point(32,16)),[t]}},{key:"reset",value:function(){Object(b.a)(this.outputPins,1)[0].setLogicState(new G({x:this.bitMask()}))}}]),i}(T);Q.opFuncs=(W={},Object(f.a)(W,z.AND,Q.prototype.opAnd),Object(f.a)(W,z.NAND,Q.prototype.opNand),Object(f.a)(W,z.OR,Q.prototype.opOr),Object(f.a)(W,z.NOR,Q.prototype.opNor),Object(f.a)(W,z.XOR,Q.prototype.opXor),Object(f.a)(W,z.XNOR,Q.prototype.opXnor),Object(f.a)(W,z.BUF,Q.prototype.opBuf),Object(f.a)(W,z.NOT,Q.prototype.opNot),Object(f.a)(W,z.UNKNOWN,(function(){throw new Error("Unsupported type")})),W);var K=Q,V=i(26),Z=i.n(V),H=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(t){var n;return Object(h.a)(this,i),(n=e.call(this,Object(m.a)(Object(m.a)({},t),{},{type:U.OUTPUT,flags:0}))).on=!1,n}return Object(u.a)(i,[{key:"operate",value:function(){this.on=1===this.inputPins[0].state.v}},{key:"extraRender",value:function(){var t=this.on?"auto":"none";return[Object(p.jsx)("circle",{className:"bulb-glow",cx:16,cy:16,r:32,display:t},0)]}},{key:"setUpBody",value:function(){return new this.scope.Path("M 27.3137084989848 27.3137084989848 A 16 16 90 1 0 4.68629150101524 27.3137084989848 Q 9.238107812 31.86552481 10.71553501 36 Q 11.21553501 37.39921453 11.71553501 40 C 12.21553501 42.60078547 19.78446499 42.60078547 20.28446499 40 Q 20.78446499 37.39921453 21.28446499 36 Q 22.76189219 31.86552481 27.3137085 27.3137085")}},{key:"setUpInputPins",value:function(t){var e=this.body.bounds.bottom,i=new B({parent:this,pinType:D.INPUT,orientation:S.DOWN,board:this.board});return i.updateGeometry(new Z.a.Point(16,e)),[i]}},{key:"reset",value:function(){}}]),i}(T),Y=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(t){var n;Object(h.a)(this,i),n=e.call(this,Object(m.a)(Object(m.a)({},t),{},{type:U.INPUT,flags:0,delay:10}));var s=Object(b.a)(n.outputPins,1)[0],o=new A({source:s,sink:s});return s.connections.set(s.uuid,o),n}return Object(u.a)(i,[{key:"operate",value:function(){var t=this.outputPins[0].state.negated(1);this.postEvent(t)}},{key:"setUpBody",value:function(t){var e=this.scope,i=e.Path,n=e.Point,s=e.Size;return new i.Rectangle(new n(0,0),new s(32,32))}},{key:"setUpOutputPins",value:function(t){var e=new B({parent:this,pinType:D.OUTPUT,orientation:S.RIGHT,board:this.board});return e.updateGeometry(new this.scope.Point(32,16)),[e]}},{key:"extraRender",value:function(){return[Object(p.jsx)("path",{className:"decoration",d:i.clockPath,fill:"none"},0)]}},{key:"reset",value:function(){Object(b.a)(this.outputPins,1)[0].setLogicState(new G({v:0})),this.operate()}}]),i}(T);Y.clockPath="M4,12L8,12L8,20L16,20L16,12L24,12L24,20L28,20";var J=Y,q=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(t){return Object(h.a)(this,i),e.call(this,Object(m.a)(Object(m.a)({},t),{},{type:U.INPUT,flags:0}))}return Object(u.a)(i,[{key:"operate",value:function(){}},{key:"setUpBody",value:function(t){var e=this.scope,i=e.Path,n=e.Point,s=e.Size;return new i.Rectangle(new n(0,0),new s(32*this.width,32))}},{key:"setUpOutputPins",value:function(t){var e=new B({parent:this,pinType:D.OUTPUT,orientation:S.RIGHT,board:this.board,width:this.width});return e.updateGeometry(new this.scope.Point(32*this.width,16)),[e]}},{key:"extraRender",value:function(){for(var t=Object(b.a)(this.outputPins,1)[0],e=[],i=0;i<this.width;i++){var n=["switch"],s="0";t.state.v>>i&1&&(n.push("on"),s="1");var o=16+32*(this.width-i-1);e.push(Object(p.jsx)("circle",{className:n.join(" "),cx:o,cy:16,r:12,onClick:this.handleClick.bind(this,i)},i)),e.push(Object(p.jsx)("text",{className:"center",color:"red",x:o,y:16,children:s}))}return e}},{key:"handleClick",value:function(t){var e=Object(b.a)(this.outputPins,1)[0],i=e.state.v^1<<t;e.setLogicState(new G({v:i}))}},{key:"reset",value:function(){}}]),i}(T),$=function(){function t(e){var i;Object(h.a)(this,t),this.subtype=void 0,this.type=void 0,this.label=void 0,this.component=void 0,this.type=e.type,this.subtype=e.subtype,this.label=null!==(i=e.label)&&void 0!==i?i:"<NO LABEL>",this.component=this.make()}return Object(u.a)(t,[{key:"make",value:function(t){var e,i=null!==(e=null===t||void 0===t?void 0:t.scope)&&void 0!==e?e:L;switch(this.type){case U.GATE:return new K({subtype:this.subtype,scope:i,board:t});case U.OUTPUT:return new H({subtype:0,board:t,scope:i});case U.INPUT:return this.makeInput(this.subtype,i,t);default:throw new Error("Unsupported Part Type")}}},{key:"makeInput",value:function(t,e,i){switch(t){case 0:return new J({board:i,scope:e,subtype:0});case 1:return new q({subtype:1,board:i,scope:e});default:throw Error("Unsupported Part Type")}}}]),t}();$.data=void 0;var tt=$,et=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(){return Object(h.a)(this,i),e.apply(this,arguments)}return Object(u.a)(i,[{key:"renderPart",value:function(t){var e=t.component,i=e.render(),n=t.label,s=e.geometry.bounds,o=s.left,a=s.top,r=s.width,c=s.height;o-=2,a-=2,r+=4,c+=4;var h=n.replace(" ","_");return Object(p.jsxs)("div",{className:"part",draggable:!0,onDragStart:this.handleDragStart.bind(this,h,t),onDragEnd:this.handleDragEnd.bind(this),children:[Object(p.jsx)("div",{className:"part-image-container",children:Object(p.jsx)("svg",{className:"part-image",id:h,viewBox:"".concat(o," ").concat(a," ").concat(r," ").concat(c),width:r,height:c,children:i})}),Object(p.jsx)("div",{className:"part-label",children:n})]},e.uuid)}},{key:"handleDragStart",value:function(t,e,i){tt.data=e;var n=document.getElementById(t),s=e.component.geometry.bounds.center,o=s.x,a=s.y;i.dataTransfer.setDragImage(n,o+2,a+2),i.dataTransfer.effectAllowed="move"}},{key:"handleDragEnd",value:function(){tt.data=void 0}},{key:"render",value:function(){return Object(p.jsx)("div",{className:"drawer",children:this.props.parts.map(this.renderPart.bind(this))})}}]),i}(o.a.Component),it=(i(38),function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(t){var n;return Object(h.a)(this,i),(n=e.call(this,t)).ref=void 0,n.resizeObserer=void 0,n.sPoint=void 0,n.select=void 0,n.select=null,n.state={viewBox:{left:0,top:0,width:800,height:600},viewPort:{width:0,height:0},scaleFactor:1,pan:!1,drag:!1},n.ref=o.a.createRef(),n}return Object(u.a)(i,[{key:"onResize",value:function(t){var e=t[0].contentRect,i=e.width,n=e.height;this.setState((function(t){return{viewPort:{width:i,height:n},viewBox:{left:t.viewBox.left,top:t.viewBox.top,width:i*t.scaleFactor,height:n*t.scaleFactor}}}))}},{key:"componentDidMount",value:function(){this.setState({});var t=this.ref.current;this.resizeObserer=new ResizeObserver(this.onResize.bind(this)),this.resizeObserer.observe(t)}},{key:"componentWillUnmount",value:function(){var t;null===(t=this.resizeObserer)||void 0===t||t.disconnect()}},{key:"defs",value:function(){return Object(p.jsxs)("defs",{children:[Object(p.jsxs)("pattern",{id:"grid",x:0,y:0,width:80,height:80,viewBox:"0 0 80 80",patternUnits:"userSpaceOnUse",children:[Object(p.jsx)("path",{className:"grid",d:"M 0 0 L 0 80",strokeWidth:"2"}),Object(p.jsx)("path",{className:"grid",d:"M 10 0 L 10 80",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 20 0 L 20 80",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 30 0 L 30 80",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 40 0 L 40 80",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 50 0 L 50 80",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 60 0 L 60 80",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 70 0 L 70 80",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 80 0 L 80 80",strokeWidth:"2"}),Object(p.jsx)("path",{className:"grid",d:"M 0 0 L 80 0",strokeWidth:"2"}),Object(p.jsx)("path",{className:"grid",d:"M 0 10 L 80 10",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 0 20 L 80 20",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 0 30 L 80 30",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 0 40 L 80 40",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 0 50 L 80 50",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 0 60 L 80 60",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 0 70 L 80 70",strokeWidth:"0.5"}),Object(p.jsx)("path",{className:"grid",d:"M 0 80 L 80 80",strokeWidth:"2"})]}),Object(p.jsxs)("pattern",{id:"bus",x:0,y:0,width:3,height:3,viewBox:"0 0 3 3",patternUnits:"userSpaceOnUse",children:[Object(p.jsx)("rect",{x:2,y:0,width:1,height:1,fill:"black"}),Object(p.jsx)("rect",{x:1,y:1,width:1,height:1,fill:"black"}),Object(p.jsx)("rect",{x:0,y:2,width:1,height:1,fill:"black"})]}),Object(p.jsxs)("radialGradient",{id:"bulb-glow",children:[Object(p.jsx)("stop",{offset:"0%",stopColor:"rgb(255, 255, 128)"}),Object(p.jsx)("stop",{offset:"100%",stopColor:"rgba(255, 255, 255, 0)"})]})]},"defs")}},{key:"renderGrid",value:function(){var t=this.state.viewBox.left,e=this.state.viewBox.width,i=this.state.viewBox.top,n=this.state.viewBox.height;return Object(p.jsx)("rect",{x:t,y:i,width:e,height:n,fill:"url(#grid)"},"grid")}},{key:"render",value:function(){var t,e,i=this,n=this.state.viewBox.left,s=this.state.viewBox.width,o=this.state.viewBox.top,a=this.state.viewBox.height,r=null===(t=this.select)||void 0===t||null===(e=t.exportSVG())||void 0===e?void 0:e.getAttribute("d"),c={onGateMouseDown:this.handleGateMouseDown.bind(this),onGateMouseUp:this.handleGateMouseUp.bind(this),onGateContextMenu:this.handleGateContextMenu.bind(this),onPinMouseDown:this.handlePinMouseDown.bind(this)},h=[];this.props.board.connections.forEach((function(t){return h.push(t.render())}));var u=[];return this.props.board.components.forEach((function(t){return u.push(t.render(c))})),Object(p.jsx)("div",{ref:this.ref,style:{width:"100%",height:"100%"},children:Object(p.jsx)("svg",{className:"board-wrapper",style:this.state.viewPort,xmlns:"http://www.w3.org/2000/svg",onWheel:function(t){return i.handleWheel(t)},onMouseMove:function(t){return i.handleMouseMove(t)},onMouseDown:function(t){return i.handleMouseDown(t)},onMouseUp:function(t){return i.handleMouseUp(t)},onMouseLeave:function(t){return i.handleMouseExit(t)},onDragEnter:this.handleDragEnter.bind(this),onDragOver:function(t){return i.handleDragOver(t)},onDrop:function(t){return i.handleDrop(t)},children:Object(p.jsxs)("svg",{className:"board",preserveAspectRatio:"xMinYMin slice",xmlns:"http://www.w3.org/2000/svg",viewBox:"".concat(n," ").concat(o," ").concat(s," ").concat(a),onScroll:function(){return console.log("scroll")},children:[this.defs(),this.renderGrid(),Object(p.jsx)("circle",{className:"origin",x:"0",y:"0",r:"40",fill:"red"}),h,u,r&&Object(p.jsx)("path",{className:"select",d:r,vectorEffect:"non-scaling-stroke"})]})})})}},{key:"clearSelection",value:function(){var t,e=Object(y.a)(this.scope.project.selectedItems);try{for(e.s();!(t=e.n()).done;){t.value.selected=!1}}catch(i){e.e(i)}finally{e.f()}}},{key:"getViewCoordinates",value:function(t){var e=t.currentTarget.getBoundingClientRect(),i=e.left,n=e.top,s=e.width,o=e.height,a=t.pageX-i,r=t.pageY-n,c=t.movementX,h=t.movementY,u=this.state.viewBox.width,l=this.state.viewBox.height,d=a/s,p=r/o;return{x:this.state.viewBox.left+d*u,y:this.state.viewBox.top+p*l,rx:d,ry:p,dx:c/s*u,dy:h/o*l}}},{key:"enableDrag",value:function(t){t.stopPropagation(),this.setState({drag:!0})}},{key:"disableDrag",value:function(t){t.stopPropagation(),this.setState({drag:!1})}},{key:"handleDragEnter",value:function(t){t.preventDefault(),t.dataTransfer.effectAllowed="move"}},{key:"handleDragOver",value:function(t){t.preventDefault(),t.dataTransfer.effectAllowed="move"}},{key:"handleDrop",value:function(t){t.preventDefault();var e=this.getViewCoordinates(t),i=e.x,n=e.y,s=tt.data;if(s){var o=s.make(this.props.board);o.geometry.translate(new j.a.Point(i-16,n-16)),this.props.board.addComponent(o),this.setState({})}}},{key:"handleMouseDown",value:function(t){t.preventDefault(),t.stopPropagation(),this.clearSelection();var e=this.props.board.scope,i=e.Path,n=e.Point,s=e.Rectangle,o=e.Size,a=this.getViewCoordinates(t),r=a.x,c=a.y;this.sPoint=new n(r,c);var h=new s(this.sPoint,new o(0,0));this.select=new i.Rectangle(h),this.setState({})}},{key:"handleMouseUp",value:function(t){t.preventDefault(),t.stopPropagation(),this.select&&(this.select.remove(),this.select=null),this.setState({pan:!1,drag:!1})}},{key:"handleMouseExit",value:function(t){this.select&&(this.select.remove(),this.select=null),this.setState({pan:!1,drag:!1})}},{key:"isSelected",value:function(t){var e=this.select,i=e.bounds,n=t.parent.matrix,s=n.inverted();t.transform(n);var o=t.intersects(e)||t.isInside(i)||t.contains(i.center);return t.transform(s),o}},{key:"handleMouseMove",value:function(t){var e=this.getViewCoordinates(t),i=e.x,n=e.y,s=e.dx,o=e.dy;if(this.state.drag){t.stopPropagation(),t.preventDefault();var a,r=this.props.board.scope.project.getItems({selected:!0,data:{type:"Component"}}),c=Object(y.a)(r);try{for(c.s();!(a=c.n()).done;){var h=a.value,u=new j.a.Point(s,o);h.parent.translate(u)}}catch(U){c.e(U)}finally{c.f()}this.setState({})}if(this.select&&this.sPoint){var l=this.select,d=[this.sPoint.x,this.sPoint.y],p=d[0],v=d[1];if(i===p&&n===v){var f,b=Object(y.a)(l.segments);try{for(b.s();!(f=b.n()).done;){f.value.point=this.sPoint}}catch(U){b.e(U)}finally{b.f()}}i<=p&&(l.segments[0].point.x=i,l.segments[1].point.x=i,l.segments[2].point.x=p,l.segments[3].point.x=p),i>=p&&(l.segments[0].point.x=p,l.segments[1].point.x=p,l.segments[2].point.x=i,l.segments[3].point.x=i),n<=v&&(l.segments[0].point.y=v,l.segments[1].point.y=n,l.segments[2].point.y=n,l.segments[3].point.y=v),n>=v&&(l.segments[0].point.y=n,l.segments[1].point.y=v,l.segments[2].point.y=v,l.segments[3].point.y=n);var m,g=this.props.board.scope.project,O=g.getItems({data:{type:"Component"}}),w=!1,x=Object(y.a)(O);try{for(x.s();!(m=x.n()).done;){var k=m.value;this.isSelected(k)?(w=!0,k.selected=!0):k.selected=!1}}catch(U){x.e(U)}finally{x.f()}var P,M=g.getItems({data:{type:"Pin"}}),N=Object(y.a)(M);try{for(N.s();!(P=N.n()).done;){var T=P.value;T.selected=!w&&this.isSelected(T)}}catch(U){N.e(U)}finally{N.f()}this.setState({}),this.forceUpdate()}this.state.pan&&this.setState({viewBox:{top:this.state.viewBox.top-o,left:this.state.viewBox.left-s,width:this.state.viewBox.width,height:this.state.viewBox.height}})}},{key:"handleWheel",value:function(t){var e=this.getViewCoordinates(t),n=e.x,s=e.y,o=e.rx,a=e.ry,r=this.state.viewPort.width,c=this.state.viewPort.height,h=this.state.scaleFactor,u=i.between(1/16,Math.pow(2,t.deltaY/1e3)*h,4),l=r*u,d=c*u,p={left:n-o*l,top:s-a*d,width:l,height:d};this.setState({scaleFactor:u,viewBox:p})}},{key:"handleGateMouseDown",value:function(t,e){e.preventDefault(),e.stopPropagation(),console.log("Gate Down");var i=this.props.board.scope.project.getItems({selected:!0}),n=t.body;if(!i.includes(n)){var s,o=Object(y.a)(i);try{for(o.s();!(s=o.n()).done;){s.value.selected=!1}}catch(a){o.e(a)}finally{o.f()}n.selected=!0}this.setState({drag:!0})}},{key:"handleGateMouseUp",value:function(t,e){e.preventDefault(),console.log("up gate")}},{key:"handleGateContextMenu",value:function(t,e){e.shiftKey||(e.stopPropagation(),e.preventDefault(),console.log("context g!"))}},{key:"handlePinMouseDown",value:function(t,e){e.stopPropagation(),e.preventDefault();var i=this.props.board.scope.project.getItems({selected:!0,data:{type:"Pin"}}).map((function(t){return t.data.logical})),n=i.filter((function(t){return t.pinType===D.OUTPUT})).length;if(console.log("Num outputs: ".concat(n)),n<=1){var s,o=Object(y.a)(i);try{for(o.s();!(s=o.n()).done;){var a=s.value;this.makeConnection(a,t)}}catch(r){o.e(r)}finally{o.f()}}}},{key:"makeConnection",value:function(t,e){console.log("attempting connection");var i=t.connectTo(e);i&&(this.props.board.addConnection(i),this.setState({}))}},{key:"scope",get:function(){return this.props.board.scope}}],[{key:"between",value:function(t,e,i){return Math.min(Math.max(t,e),i)}}]),i}(o.a.Component)),nt=i(21),st=i.n(nt),ot=function(){function t(e){Object(h.a)(this,t),this.data=void 0,this.left=null,this.right=null,this.weight=1,this.max_depth=1,this.data=e.data}return Object(u.a)(t,[{key:"rotateLeft",value:function(){var t,e,i;if(!this.right)throw Error("Impossible rotation");var n=this.right,s=n.left;return this.right=s,this.weight-=n.weight,this.weight+=(null===s||void 0===s?void 0:s.weight)||0,n.left=this,n.weight-=(null===s||void 0===s?void 0:s.weight)||0,n.weight+=this.weight,this.max_depth=Math.max((null===(t=this.left)||void 0===t?void 0:t.max_depth)||0,(null===(e=this.right)||void 0===e?void 0:e.max_depth)||0)+1,n.max_depth=Math.max(n.left.max_depth,(null===(i=n.right)||void 0===i?void 0:i.max_depth)||0)+1,n}},{key:"rotateRight",value:function(){var t,e,i;if(!this.left)throw Error("Impossible rotation");var n=this.left,s=n.right;return this.left=s,this.weight-=n.weight,this.weight+=(null===s||void 0===s?void 0:s.weight)||0,n.right=this,n.weight-=(null===s||void 0===s?void 0:s.weight)||0,n.weight+=this.weight,this.max_depth=Math.max((null===(t=this.left)||void 0===t?void 0:t.max_depth)||0,(null===(e=this.right)||void 0===e?void 0:e.max_depth)||0)+1,n.max_depth=Math.max((null===(i=n.left)||void 0===i?void 0:i.max_depth)||0,n.right.max_depth)+1,n}},{key:"slant",value:function(){var t,e,i=(null===(t=this.left)||void 0===t?void 0:t.max_depth)||0;return((null===(e=this.right)||void 0===e?void 0:e.max_depth)||0)-i}},{key:"balance",value:function(){var t=this.slant();return t<-1&&this.left?(this.left.slant()>=1&&(this.left=this.left.rotateLeft()),this.rotateRight()):t>1&&this.right?(this.right.slant()<=-1&&(this.right=this.right.rotateRight()),this.rotateLeft()):this}},{key:"insert",value:function(e,i){var n=i(e,this.data),s=!1;if(n<0)if(this.left){var o=this.left.insert(e,i),a=Object(b.a)(o,2);this.left=a[0],s=a[1]}else this.left=new t({data:e}),s=!0;else{if(!(n>0))return this.data=e,[this,!1];if(this.right){var r=this.right.insert(e,i),c=Object(b.a)(r,2);this.right=c[0],s=c[1]}else this.right=new t({data:e}),s=!0}var h,u,l=this;s&&(this.weight+=1,this.max_depth=Math.max((null===(h=this.left)||void 0===h?void 0:h.max_depth)||0,(null===(u=this.right)||void 0===u?void 0:u.max_depth)||0)+1,l=this.balance());return[l,s]}},{key:"find",value:function(t,e){var i=e(t,this.data);return i<0?this.left&&this.left.find(t,e):i>0?this.right&&this.right.find(t,e):this.data}},{key:"popFirst",value:function(){if(this.left){var t,e=this.left.popFirst(),i=Object(b.a)(e,2),n=i[0],s=i[1];return this.left=n,this.weight-=1,this.max_depth=Math.max((null===n||void 0===n?void 0:n.max_depth)||0,(null===(t=this.right)||void 0===t?void 0:t.max_depth)||0)+1,[this.balance(),s]}return[this.right,this.data]}},{key:"popLast",value:function(){if(this.right){var t,e=this.right.popFirst(),i=Object(b.a)(e,2),n=i[0],s=i[1];return this.right=n,this.weight-=1,this.max_depth=Math.max((null===n||void 0===n?void 0:n.max_depth)||0,(null===(t=this.left)||void 0===t?void 0:t.max_depth)||0)+1,[this.balance(),s]}return[this.left,this.data]}},{key:"remove",value:function(t,e){var i,n,s,o=e(t,this.data),a=this;if(o<0)if(this.left){var r=this.left.remove(t,e),c=Object(b.a)(r,2);this.left=c[0],i=c[1]}else i=!1;else if(o>0)if(this.right){var h=this.right.remove(t,e),u=Object(b.a)(h,2);this.right=u[0],i=u[1]}else i=!1;else{if(this.left){var l=this.left.popLast(),d=Object(b.a)(l,2);this.left=d[0],this.data=d[1]}else{if(!this.right)return[null,!0];var p=this.right.popFirst(),v=Object(b.a)(p,2);this.right=v[0],this.data=v[1]}i=!0}i&&(this.weight-=1,this.max_depth=Math.max((null===(n=this.left)||void 0===n?void 0:n.max_depth)||0,(null===(s=this.right)||void 0===s?void 0:s.max_depth)||0)+1,a=this.balance());return[a,i]}},{key:"clear",value:function(){this.left&&(this.left.clear(),this.left=null),this.right&&(this.right.clear(),this.right=null)}}]),t}(),at=st.a.mark(rt);function rt(t){var e,i,n;return st.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(null!==t.root){s.next=2;break}return s.abrupt("return");case 2:e=[],i=t.root;case 4:if(!i&&!e.length){s.next=12;break}for(;i;)e.push(i),i=i.left;return n=e.pop(),s.next=9,n.data;case 9:n.right&&(i=n.right),s.next=4;break;case 12:return s.abrupt("return");case 13:case"end":return s.stop()}}),at)}var ct=function(t){function e(t){Object(h.a)(this,e),this.cmp=void 0,this.root=null,this.cmp=t.cmp}return Object(u.a)(e,[{key:"insert",value:function(t){if(this.root){var e=this.root.insert(t,this.cmp),i=Object(b.a)(e,1);this.root=i[0]}else this.root=new ot({data:t})}},{key:"remove",value:function(t){if(!this.root)return!1;var e=this.root.remove(t,this.cmp),i=Object(b.a)(e,2);return this.root=i[0],i[1]}},{key:"clear",value:function(){this.root&&(this.root.clear(),this.root=null)}},{key:"find",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e=e||this.cmp,this.root&&this.root.find(t,e)||null}},{key:"first",value:function(){if(!this.root)return null;for(var t=this.root;t.left;)t=t.left;return t.data}},{key:"popFirst",value:function(){if(!this.root)return null;var t=this.root.popFirst(),e=Object(b.a)(t,2),i=e[0],n=e[1];return this.root=i,n}},{key:"size",value:function(){var t;return(null===(t=this.root)||void 0===t?void 0:t.weight)||0}},{key:t,value:function(){return rt(this)}}]),e}(Symbol.iterator),ht=function(){function t(e){Object(h.a)(this,t),this.pin=void 0,this.time=void 0,this.state=void 0,this.pin=e.pin,this.time=e.time,this.state=e.state}return Object(u.a)(t,[{key:"apply",value:function(){this.pin.setLogicState(this.state)}},{key:"cmp",value:function(t){return this.time===t.time?this.pin.uuid.localeCompare(t.pin.uuid):this.time-t.time}}]),t}(),ut=function(){function t(){Object(h.a)(this,t),this.components=new Map,this.connections=new Map,this.scope=C(),this.simulation=new ct({cmp:function(t,e){return t.cmp(e)}}),this.simulationTimerId=-1,this.simulationCurrentTime=0,this.simulationIntervalMs=25,this.simulationStepSize=1,this.updateFunc=function(){}}return Object(u.a)(t,[{key:"render",value:function(){return Object(p.jsx)(it,{board:this})}},{key:"postEvent",value:function(t,e,i){var n=new ht({pin:e,time:this.simulationCurrentTime+i,state:t});this.simulation.insert(n)}},{key:"startSimulation",value:function(){-1===this.simulationTimerId&&(this.simulationTimerId=setInterval(this.advanceSimulation.bind(this),this.simulationIntervalMs))}},{key:"stopSimulation",value:function(){-1!==this.simulationTimerId&&(clearInterval(this.simulationTimerId),this.simulationTimerId=-1,this.simulation.clear(),this.simulationCurrentTime=0,this.components.forEach((function(t){return t.reset()})),this.components.forEach((function(t){return t.operate()})))}},{key:"pauseSimulation",value:function(){-1!==this.simulationTimerId&&(clearInterval(this.simulationTimerId),this.simulationTimerId=-1)}},{key:"advanceSimulation",value:function(){for(var t=this.simulationCurrentTime+this.simulationStepSize;this.simulation.size()&&this.simulation.first().time<=t;){var e=this.simulation.popFirst();this.simulationCurrentTime=e.time,e.apply()}this.simulationCurrentTime=t,this.updateFunc()}},{key:"simulationRunning",get:function(){return-1!==this.simulationTimerId}},{key:"simulationPaused",get:function(){return!this.simulationRunning&&0!==this.simulationCurrentTime}},{key:"simulationStopped",get:function(){return!this.simulationRunning&&0===this.simulationCurrentTime}},{key:"addComponent",value:function(t){this.components.set(t.uuid,t)}},{key:"addConnection",value:function(t){this.connections.set(t.uuid,t)}},{key:"removeComponent",value:function(t){this.components.delete(t)}},{key:"removeConnection",value:function(t){this.connections.delete(t)}}]),t}(),lt=(i(40),i(14)),dt=i(16),pt=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(){return Object(h.a)(this,i),e.apply(this,arguments)}return Object(u.a)(i,[{key:"render",value:function(){var t=this.props.board.simulationRunning,e=!t&&this.props.board.simulationStopped;return Object(p.jsx)("div",{className:"toolbar",role:"toolbar",children:Object(p.jsxs)("div",{className:"group",children:[Object(p.jsxs)("button",{className:t?"pressed":"",onClick:this.onPlay.bind(this),children:[Object(p.jsx)(lt.a,{className:"default",icon:dt.b,style:{position:"fixed"}}),Object(p.jsx)(lt.a,{className:"active",icon:dt.a})]}),Object(p.jsx)("button",{onClick:this.onStop.bind(this),disabled:e,children:Object(p.jsx)(lt.a,{icon:dt.d})}),Object(p.jsx)("button",{onClick:this.onStep.bind(this),disabled:t,children:Object(p.jsx)(lt.a,{icon:dt.c})}),Object(p.jsx)("div",{children:this.props.board.simulationCurrentTime})]})})}},{key:"onPlay",value:function(){this.props.board.simulationRunning?this.props.board.pauseSimulation():this.props.board.startSimulation(),this.setState({})}},{key:"onStop",value:function(){this.props.board.stopSimulation(),this.setState({})}},{key:"onStep",value:function(){this.props.board.advanceSimulation()}}]),i}(o.a.Component),vt=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(){var t;Object(h.a)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))).board=new ut,t.parts=[new tt({type:U.GATE,subtype:z.AND,label:"AND"}),new tt({type:U.GATE,subtype:z.NAND,label:"NAND"}),new tt({type:U.GATE,subtype:z.OR,label:"OR"}),new tt({type:U.GATE,subtype:z.NOR,label:"NOR"}),new tt({type:U.GATE,subtype:z.XOR,label:"XOR"}),new tt({type:U.GATE,subtype:z.XNOR,label:"XNOR"}),new tt({type:U.GATE,subtype:z.BUF,label:"BUF"}),new tt({type:U.GATE,subtype:z.NOT,label:"NOT"}),new tt({type:U.OUTPUT,subtype:0,label:"Bulb"}),new tt({type:U.INPUT,subtype:0,label:"Clock"}),new tt({type:U.INPUT,subtype:1,label:"Switch"})],t}return Object(u.a)(i,[{key:"componentDidMount",value:function(){var t=this;this.board.updateFunc=function(){return t.setState({})}}},{key:"componentWillUnmount",value:function(){this.board.updateFunc=function(){}}},{key:"render",value:function(){return Object(p.jsxs)("div",{style:{width:"100%",height:"100%"},children:[Object(p.jsxs)("div",{children:["Menu",Object(p.jsx)(pt,{board:this.board})]}),Object(p.jsxs)("div",{style:{width:"100%",height:"100%"},children:[Object(p.jsx)(v,{content:Object(p.jsx)(et,{parts:this.parts})}),this.board.render()]})]})}}]),i}(o.a.Component);r.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(vt,{})}),document.getElementById("root")),c()}},[[46,1,2]]]);
//# sourceMappingURL=main.f25cca18.chunk.js.map